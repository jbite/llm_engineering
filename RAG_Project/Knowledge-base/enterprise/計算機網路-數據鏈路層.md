# 數據鏈路層

## 信道類型

* 點對點信道
* 廣播信道，這種信道使用一對多的廣播通信方式，因此過程比較複雜

#### 鏈路

link是一條點到點的物理線路段，中間沒有呈何其他的交換結點。

* 一條鏈路只是一條通路的一個組成部分。

數據鏈路除了物理線路外，還必須有通信協議來控制這些數據的傳輸。若把實現這些協議的硬體和軟體加到鏈路上，就構成了數據鏈路

* 現最常用的方法是使用適配器(即網卡)來實現這些協議的硬體和軟體。
* 一般的適配器都包括了數據鏈路層和物理層這兩層的功能。

數據鏈路層傳送的是幀

包裝的是網路層的ip數據報文

##### 封裝成幀

|-------------------幀-------------------------------|

幀開始--幀首----數據部份----幀尾--幀結束

0000 0001                                       0000 0100

開始字符(SOH)                                 結束字符(EOT)

##### 透明傳輸

如果傳輸字符出現SOH或EOT就填充ESC(二進制編碼是1B)

接收端的數據鏈路層在將數據送往網路層之前刪除插入的轉義字符

##### 差錯控制

傳輸過程中可能會產生比特差錯，1可能會變成0，0可能也變成1

在一段時間內，傳輸錯誤的比特占所傳輸比特總數的比率稱為誤碼率BER

誤碼率與信噪就很大的關係

為了保證數據傳輸的可靠性滿在計算機網路傳輸數據時，必須采用各種差錯檢測措施

### ppp協議

* 簡單
* 封裝成幀
* 透明性

rfc1661

* 數據鏈路層協議可以用異步串行或同步串介質
* 它使用LCP(鏈路控制協議)建立並維護數據鏈路連接
* 網路控制協議(NCP)允許在點到點連接上使用多種網路層協議，如圖所示

![image-20200712225819587](D:\google\電子書\學習筆記\image-20200712225819587.png)

數據內容中如果出現了標志字段的值，可能被誤為是"標志"，

遇到這種情形，就將0x7E字節轉變成為2字節序列(0x7D 0x5E)

若數據字段中出現一個0x7D的字節，則將其轉變成2字節序列(0x7D, 0x5D)

若數據字據中出現ASCII碼的控制字符(即數值小于0x20的字符)，則在該字符前面加入一個0x7D字節，同時將該字符的編碼加以改變

### 不使用序號和確認機制

ppp協議之所以不使用序號和確認機制是出于以下的考慮:

* 在數據鏈路層出現差錯的概不大時，使用比較簡單的ppp協議較為合理。
* 在internet網路環境下，ppp的信息字段放入的數據是ip數據報。數據鏈路層的可靠傳輸並不能夠保證網路層的傳輸也是可靠的。
* 幀檢驗序列FCS字段可保證無差錯接收。 

### ppp協議的工作狀態

當用戶撥號接入isp時，路由器的調制解器對撥號做確認，並建立一條物理連接。

PC向路由器發送一系列的LCP分組(封裝成多個ppp幀)。

這些分組及響應選擇一些ppp參數，和進行網路層配置，NCP給新接入的pc機分配一個臨時的ip地址，使pc機成為internet上的一個主機。

通信完畢時，NCP釋放網路層連接，收回原來分配出去的ip地址。接著，LCP釋放數據鏈路層連接。最後釋放的是物理層的連接



### CSMA/CD

廣播信道中使用的監聽方式

傳播時延對載波監聽的影響

不能進行全雙工通信只能進行雙向交替通信(半雙工)

每個站在發送數據之後的一小段時間內，存在著遭遇碰撞的可能性。

這種發送的不確定性使整個以太網的平均通信量遠小于以太網的最高數據率



爭用率

以太網最小有效幀為64字節，小於64字節，都是由於沖衝突而異常中止的無效幀

網線超過100米，就會影響衝突檢測

#### 二進制指數類型退避算法

發生碰撞的點，停止發送數據後，要推遲一定(隨機)時間後才能再發送數據

### 乙太網的兩個標準

